(function(t){function e(e){for(var i,a,o=e[0],h=e[1],c=e[2],u=0,d=[];u<o.length;u++)a=o[u],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&d.push(n[a][0]),n[a]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(t[i]=h[i]);l&&l(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],i=!0,o=1;o<s.length;o++){var h=s[o];0!==n[h]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=s[0]))}return t}var i={},n={app:0},r=[];function a(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=i,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/elgamal/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],h=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var l=h;r.push([1,"chunk-vendors"]),s()})({0:function(t,e){},1:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Main")],1)},r=[],a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrapper"},[s("h1",[t._v("ELGAMAL Signature Algorithm")]),s("div",{staticClass:"main"},[s("div",{staticClass:"left"},[s("h2",[t._v("Отправитель")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.m,expression:"m"}],staticClass:"text",attrs:{cols:"30",rows:"10"},domProps:{value:t.m},on:{input:function(e){e.target.composing||(t.m=e.target.value)}}}),s("br"),t._v(" Открытый ключ: "),s("div",[t._v("p: "+t._s(t.p))]),s("div",[t._v("g: "+t._s(t.g))]),s("div",[t._v("y: "+t._s(t.y))]),s("br"),t._v(" Закрытый ключ: "),s("div",[t._v("x: "+t._s(t.x))]),s("br"),t._v(" Дайджест: "),s("div",[t._v(t._s(t.hash))]),s("br"),t._v(" Сессионный ключ: "),s("div",[t._v("k: "+t._s(t.k))]),s("br"),t._v(" Шифротекст: "),s("ol",{attrs:{type:"A"}},[s("li",[t._v(t._s(t.A))]),s("li",[t._v(t._s(t.B))])])]),s("div",{staticClass:"right"},[s("h2",[t._v("Получатель")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.send,expression:"send"}],staticClass:"text",attrs:{cols:"30",rows:"10"},domProps:{value:t.send},on:{input:function(e){e.target.composing||(t.send=e.target.value)}}}),s("br"),s("div",[t._v("Вычисляемые значения")]),s("hr",{attrs:{width:"100%"}}),s("table",{attrs:{cellspacing:"0"}},[s("tr",[s("td",[t._v("Дайджест")]),s("td",[t._v(t._s(t.hash1))])]),s("tr",[t._m(0),s("td",[t._v(t._s(t.res1))])]),s("tr",[t._m(1),s("td",[t._v(t._s(t.res2))])]),s("tr",[s("td",{class:{green:t.checked,red:!t.checked},attrs:{colspan:"2"}},[t.checked?s("div",[t._v("Verified signature")]):s("div",[t._v("Invalid signature")])])])]),s("br"),s("br"),s("div",[t._v("Получаемые значения")]),s("hr",{attrs:{width:"100%"}}),t._v(" Открытый ключ: "),s("div",[t._v("p: "+t._s(t.p))]),s("div",[t._v("g: "+t._s(t.g))]),s("div",[t._v("y: "+t._s(t.y))]),s("br"),t._v(" Шифротекст: "),s("div",[s("ol",{attrs:{type:"A"}},[s("li",[t._v(t._s(t.A))]),s("li",[t._v(t._s(t.B))])])])])])])},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",[t._v("y"),s("sup",[t._v("A")]),t._v(" * A"),s("sup",[t._v("B")]),t._v(" (mod p)")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",[t._v("g"),s("sup",[t._v("hash")]),t._v(" (mod p)")])}],h=(s("d3b7"),s("25f0"),s("5c1a")),c=s.n(h),l=s("7409");String.prototype.hashCode=function(t){var e=0;if(0==this.length)return e;for(var s=0;s<this.length;s++){var i=this.charCodeAt(s);e=(e<<5)-e+i,e&=e}return l(l(e).abs()+l(t)).mod(l(t))};var u={name:"Main",data:function(){return{m:null,send:null,prime:null,p:null,g:null,x:null,y:null,k:null,A:null,B:null,salt:null,hash:null,hash1:null,bits:24,checked:0,res1:0,res2:0}},watch:{m:function(t){this.send=this.m,this.sign()},send:function(t){this.check()}},mounted:function(){this.m="Secret message",this.start()},methods:{start:function(){var t=this;c.a.prime.generateProbablePrime(this.bits,(function(e,s){t.prime=s.toString(10),t.p=l(t.prime)})),this.g=l(this.getRandomInt(this.prime)),this.x=l(this.getRandomInt(this.prime-1)),this.y=this.g.modPow(this.x,this.p)},getRandomInt:function(t){return BigInt(Math.floor(Math.random()*t).toString())},sign:function(){var t=this;if(this.m){this.hash=l(this.send.hashCode(this.p)),c.a.prime.generateProbablePrime(this.bits,(function(e,s){t.k=l(s.toString(10))}));while(l(this.p-1).lesser(this.k)||l.gcd(this.k,this.p-1).notEquals(1))c.a.prime.generateProbablePrime(this.bits,(function(e,s){t.k=l(s.toString(10))}));this.A=this.g.modPow(this.k,this.p);var e=l(this.k).modInv(this.p-1),s=l(this.p-1),i=l(this.x*this.A).mod(s),n=l(l(l(this.hash)-i).mod(s)+s);this.B=l(l(n).multiply(e)).mod(s)}else this.hash=0},check1:function(t,e,s,i){return t&&e&&s&&i?l(l(t).modPow(l(e),l(i))*l(e).modPow(l(s),l(i))).mod(l(i)):""},check2:function(t,e,s){return t&&e&&s?l(t).modPow(l(e),l(s)):""},check:function(){if(this.send)return this.hash1=l(this.send.hashCode(this.p)),this.res1=this.check1(this.y,this.A,this.B,this.p).value,this.res2=this.check2(this.g,this.hash1,this.p).value,this.res1==this.res2?this.checked=this.res1:this.checked=0,this.check1(this.y,this.A,this.B,this.p).value==this.check2(this.g,this.hash1,this.p).value;this.hash1=0}}},d=u,v=(s("c3bf"),s("2877")),p=Object(v["a"])(d,a,o,!1,null,"6b317154",null),f=p.exports,m={name:"App",components:{Main:f}},_=m,g=(s("5c0b"),Object(v["a"])(_,n,r,!1,null,null,null)),b=g.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(b)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";s("9c0c")},"9c0c":function(t,e,s){},c3bf:function(t,e,s){"use strict";s("e401")},e401:function(t,e,s){}});
//# sourceMappingURL=app.e00b2be8.js.map